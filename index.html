<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Text-Only</title>
    <!-- Link to the external stylesheet -->
    <link rel="stylesheet" href="style.css">
</head>
<body>

    <div class="container">
        <h1>TexTnews</h1>

        <!-- Tab Bar for regions -->
        <div class="tab-bar">
            <button class="tab-button active" data-region="UK">BBC UK</button>
            <button class="tab-button" data-region="ABC_AU">ABC Australia</button>
            <button class="tab-button" data-region="BBC_AU">BBC Australia</button>
        </div>

        <button id="refresh-button">Refresh...</button>
        
        <!-- Status for loading, errors, etc. -->
        <div id="status-container"></div>
        
        <!-- List where headlines will be injected -->
        <div id="headlines-list"></div>
    </div>

    <script type="module">
        // --- CONFIGURATION ---
        
        // !!! IMPORTANT !!!
        // Paste your Cloudflare Worker URL here.
        // It will look like: https://gemini-proxy.your-name.workers.dev
        const proxyApiUrl = "news-proxy.beebul.workers.dev";
        
        // --- End of Configuration ---

        // App state
        let currentRegion = "UK";
        let storyCache = {}; // Cache for fetched stories
        let isConfigValid = true;

        // DOM Elements
        const headlinesList = document.getElementById('headlines-list');
        const statusContainer = document.getElementById('status-container');
        const refreshButton = document.getElementById('refresh-button');
        const tabButtons = document.querySelectorAll('.tab-button');

        // --- CONFIGURATION CHECK ---
        if (proxyApiUrl.includes("your-name") || proxyApiUrl === "") {
            isConfigValid = false;
            const errorMsg = '<strong>Configuration Error:</strong> The "proxyApiUrl" in index.html is not set. Please edit the file and add your Cloudflare Worker URL.';
            
            // Show a floating warning box
            const showWarning = () => {
                let warningBox = document.getElementById('config-warning');
                if (!warningBox) {
                    warningBox = document.createElement('div');
                    warningBox.id = 'config-warning';
                    warningBox.style.position = 'fixed';
                    warningBox.style.top = '10px';
                    warningBox.style.left = '50%';
                    warningBox.style.transform = 'translateX(-50%)';
                    warningBox.style.backgroundColor = '#fff0f0';
                    warningBox.style.border = '1px solid #d00';
                    warningBox.style.padding = '15px';
                    warningBox.style.borderRadius = '5px';
                    warningBox.style.boxShadow = '0 2px 10px rgba(0,0,0,0.1)';
                    warningBox.style.zIndex = '1000';
                    warningBox.style.fontFamily = 'Segoe UI, sans-serif';
                    warningBox.innerHTML = `${errorMsg} <button style="margin-left: 15px; border: 1px solid #ccc; background: #f0f0f0; padding: 2px 8px; border-radius: 3px; cursor: pointer;" onclick="this.parentElement.style.display=\'none\'">Close</button>`;
                    document.body.appendChild(warningBox);
                }
            };
            showWarning();
        }

        const queryMap = {
            UK: {
                query: "Generate 8 plausible, current-sounding headlines for BBC UK news.",
                storySystem: "You are a news archivist. The user will provide a headline. Find the most relevant, real-time news story for that headline using Google Search, focusing on BBC UK. Respond with a comprehensive, multi-paragraph, plain-text summary of the full article. Do not add any of your own commentary. Just return the plain text of the story."
            },
            ABC_AU: {
                query: "Generate 8 plausible, current-sounding headlines for ABC Australia news.",
                storySystem: "You are a news archivist. The user will provide a headline. Find the most relevant, real-time news story for that headline using Google Search, focusing on ABC News (Australia). Respond with a comprehensive, multi-paragraph, plain-text summary of the full article. Do not add any of your own commentary. Just return the plain text of the story."
            },
            BBC_AU: {
                query: "Generate 8 plausible, current-sounding headlines for BBC News Australia.",
                storySystem: "You are a news archivist. The user will provide a headline. Find the most relevant, real-time news story for that headline using Google Search, focusing on BBC News Australia. Respond with a comprehensive, multi-paragraph, plain-text summary of the full article. Do not add any of your own commentary. Just return the plain text of the story."
            }
        };

        /**
         *
